"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[449],{1302:(G,b,S)=>{S.d(b,{p:()=>l});var E="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function s(x,a,h){var f=new XMLHttpRequest;f.open("GET",x),f.responseType="blob",f.onload=function(){l(f.response,a,h)},f.onerror=function(){console.error("could not download file")},f.send()}function d(x){var a=new XMLHttpRequest;a.open("HEAD",x,!1);try{a.send()}catch(h){}return a.status>=200&&a.status<=299}function X(x){try{x.dispatchEvent(new MouseEvent("click"))}catch(h){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(a)}}var m=E.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=E.saveAs||("object"!=typeof window||window!==E?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(a,h,f){var p=E.URL||E.webkitURL,g=document.createElement("a");g.download=h=h||a.name||"download",g.rel="noopener","string"==typeof a?(g.href=a,g.origin!==location.origin?d(g.href)?s(a,h,f):X(g,g.target="_blank"):X(g)):(g.href=p.createObjectURL(a),setTimeout(function(){p.revokeObjectURL(g.href)},4e4),setTimeout(function(){X(g)},0))}:"msSaveOrOpenBlob"in navigator?function(a,h,f){if(h=h||a.name||"download","string"==typeof a)if(d(a))s(a,h,f);else{var p=document.createElement("a");p.href=a,p.target="_blank",setTimeout(function(){X(p)})}else navigator.msSaveOrOpenBlob(function I(x,a){return void 0===a?a={autoBom:!1}:"object"!=typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob([String.fromCharCode(65279),x],{type:x.type}):x}(a,f),h)}:function(a,h,f,p){if((p=p||open("","_blank"))&&(p.document.title=p.document.body.innerText="downloading..."),"string"==typeof a)return s(a,h,f);var g="application/octet-stream"===a.type,T=/constructor/i.test(E.HTMLElement)||E.safari,L=/CriOS\/[\d]+/.test(navigator.userAgent);if((L||g&&T||m)&&"undefined"!=typeof FileReader){var C=new FileReader;C.onloadend=function(){var y=C.result;y=L?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=y:location=y,p=null},C.readAsDataURL(a)}else{var w=E.URL||E.webkitURL,P=w.createObjectURL(a);p?p.location=P:location.href=P,p=null,setTimeout(function(){w.revokeObjectURL(P)},4e4)}});E.saveAs=l.saveAs=l},6266:(G,b,S)=>{S.d(b,{jt:()=>r});var E=S(8279),s=(S(7796),S(5e3)),d=S(7582),X=S(1302),l=(()=>{return(t=l||(l={})).XLS="xls",t.XLSX="xlsx",t.CSV="csv",t.TXT="txt",t.JSON="json",t.OTHER="other",l;var t})();let x=(()=>{class t{constructor(){}extractRows(e,o,c){return this.getRowsAsJsonArray(e,o,null!=c?c:e._rowOutlet)}getRowsAsJsonArray(e,o,c){const u=this.getRenderedRows(e,c);return this.convertToJsonArray(o,u)}getRenderedRows(e,o){return e._getRenderedRows(o)}convertToJsonArray(e,o){const c=new Array;for(let u=0;u<o.length;u++){const _=this.convertRow(e,o[u]);c.push(this.createExcelItem(_))}return c}convertRow(e,o){const c=new Array,u=o.children;for(let _=0;_<u.length;_++)if(!this.shouldHide(e,_)){const ne=u.item(_).innerText.trim();c.push(ne)}return c}shouldHide(e,o){return!(!e||!e.includes(o))}createExcelItem(e){return Object.assign({},e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})();class a{constructor(n,e){this.extension=n,this.contentTypeHeader=e}}const g=";charset=utf-8",T=l.TXT+"/",C="application/octet-stream",w=".",A=w+l.XLSX,W=w+l.CSV,B=w+l.JSON,z=w+l.TXT,U=new a(w+l.XLS,C+g),V=new a(A,C+g),Q=new a(B,T+JSON+g),F=new a(z,T+l.TXT+g),$=new a(W,T+l.CSV+g),K=".*."+l.XLS+"$",k=new s.OlP("XLSX_LIGHTWEIGHT");class H{static save(n,e,o){const c=new Blob([n],{type:e.contentTypeHeader});let u="mat-table-exporter";o&&o.fileName&&(u=o.fileName),(0,X.p)(c,u+e.extension)}static isXls(n){return null!=n.toLowerCase().match(K)}static identifyExportType(n){return n&&H.isXls(n)?l.XLS:l.XLSX}static removeExtension(n){n.fileName=n.fileName.split(w)[0]}}class N{constructor(){}export(n,e){if(!n)throw new Error("Empty json array is provided, rows parameter is mandatory!");const o=this.getMimeType();this.createContent(n,e).then(c=>{H.save(c,o,e)})}}class D extends N{constructor(n){super(),this.sheetJsHelper=n}createContent(n,e){return(0,d.mG)(this,void 0,void 0,function*(){const o=(yield this.sheetJsHelper.getXlsx()).utils.json_to_sheet(n,{skipHeader:!0});return yield this.workSheetToContent(o,e)})}}let O=(()=>{class t{constructor(e){this.xlsxLightweight=e}getXlsx(){return(0,d.mG)(this,void 0,void 0,function*(){return this.xlsxLightweight?yield S.e(557).then(S.t.bind(S,7557,23)):yield S.e(239).then(S.t.bind(S,5239,23))})}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(k,8))},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t((0,s.LFG)(k,8))},token:t,providedIn:"root"}),t})(),ee=(()=>{class t extends D{constructor(e){super(e)}workSheetToContent(e,o){var c;return(0,d.mG)(this,void 0,void 0,function*(){return"\ufeff"+(yield this.sheetJsHelper.getXlsx()).utils.sheet_to_csv(e,{FS:null!==(c=null==o?void 0:o.delimiter)&&void 0!==c?c:","})})}getMimeType(){return $}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(O))},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t((0,s.LFG)(O))},token:t,providedIn:"root"}),t})(),te=(()=>{class t extends N{constructor(){super()}createContent(e,o){return(0,d.mG)(this,void 0,void 0,function*(){let c="";return e.forEach(u=>{c+=Object.values(u).join(this.getDelimiter(o))+"\n"}),c})}getMimeType(){return F}getDelimiter(e){return e&&e.delimiter?e.delimiter:"\t"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})(),J=(()=>{class t extends D{constructor(e){super(e)}workSheetToContent(e,o={}){return(0,d.mG)(this,void 0,void 0,function*(){const{utils:c,write:u}=yield this.sheetJsHelper.getXlsx(),_=c.book_new();return o.columnWidths&&(e["!cols"]=this.convertToWch(o.columnWidths)),this.correctTypes(o),c.book_append_sheet(_,e,o.sheet),u(_,o)})}getMimeType(){return U}correctTypes(e){e.type||(e.type="array"),e.bookType=this.getMimeType().extension.replace(".","")}convertToWch(e){return e.map(o=>({wch:o}))}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(O))},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t((0,s.LFG)(O))},token:t,providedIn:"root"}),t})(),re=(()=>{class t extends N{constructor(){super()}createContent(e,o){return(0,d.mG)(this,void 0,void 0,function*(){return JSON.stringify(e)})}getMimeType(){return Q}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Y=(()=>{class t extends J{constructor(e){super(e)}getMimeType(){return V}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(O))},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t((0,s.LFG)(O))},token:t,providedIn:"root"}),t})(),R=(()=>{class t{constructor(e){this.injector=e}getService(e){switch(e){case l.XLS.valueOf():return this.injector.get(J);case l.XLSX.valueOf():return this.injector.get(Y);case l.JSON.valueOf():return this.injector.get(re);case l.TXT.valueOf():return this.injector.get(te);case l.CSV.valueOf():return this.injector.get(ee);case l.OTHER.valueOf():return null;default:return this.injector.get(Y)}}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(s.zs3))},t.\u0275prov=(0,s.Yz7)({factory:function(){return new t((0,s.LFG)(s.gxx))},token:t,providedIn:"root"}),t})(),v=(()=>{class t{constructor(e,o,c,u){this.renderer=e,this.serviceLocator=o,this.dataExtractor=c,this._cdkTable=u,this.exportCompleted=new s.vpe,this.exportStarted=new s.vpe}exportTable(e,o){this.loadExporter(e),this._options=o,this.exportStarted.emit(),this._isIterating=!0,this._isExporting=!0,this._data=new Array,this.extractTableHeader();try{this.exportWithPagination()}catch(c){this.exportSinglePage()}}toggleRow(e){const o=this.getPaginatedRowIndex(e);this.isToggleOn(o)?this.toggleOff(o):this.toggleOn(o)}resetToggleRows(){this._selectedRows=[]}toggleOn(e){this._selectedRows=[...this._selectedRows||[],e]}toggleOff(e){this._selectedRows=this._selectedRows.filter(o=>o!==e)}isToggleOn(e){var o;return null===(o=this._selectedRows)||void 0===o?void 0:o.includes(e)}loadExporter(e){this._exporterService=e===l.OTHER.valueOf()?this.exporter:this.serviceLocator.getService(e)}exportWithPagination(){this._initialPageIndex=this.getCurrentPageIndex(),this.initPageHandler(),this.goToPage(0)}exportSinglePage(){this.extractDataOnCurrentPage(),this.extractTableFooter(),this.exportExtractedData()}extractDataOnCurrentPage(){const e=this.dataExtractor.extractRows(this._cdkTable,this.hiddenColumns);this._data=this._data.concat(this.getSelectedRows(e))}getSelectedRows(e){return this.isSelectiveExport()?e.filter((o,c)=>this._selectedRows.includes(this.getPaginatedRowIndex(c))):e}isSelectiveExport(){return this._selectedRows&&!this.isMasterToggleOff()&&!this.isMasterToggleOn()}isMasterToggleOn(){return this.compareSelectedRowCount(this.getTotalItemsCount())}isMasterToggleOff(){return this.compareSelectedRowCount(0)}compareSelectedRowCount(e){var o;return(null===(o=this._selectedRows)||void 0===o?void 0:o.length)===e}initPageHandler(){this._subscription||(this._subscription=this.getPageChangeObservable().subscribe(()=>{setTimeout(()=>{this._isIterating?(this.extractDataOnCurrentPage(),this.hasNextPage()?this.nextPage():(this._isIterating=!1,this.goToPage(this._initialPageIndex))):this._isExporting&&(this._isExporting=!1,this.extractTableFooter(),this.exportExtractedData())})}))}exportExtractedData(){this._exporterService.export(this._data,this._options),this._data=new Array,this.exportCompleted.emit()}extractSpecialRows(e){this._data.push(...this.dataExtractor.extractRows(this._cdkTable,this.hiddenColumns,e))}extractTableHeader(){this.extractSpecialRows(this._cdkTable._headerRowOutlet)}extractTableFooter(){this.extractSpecialRows(this._cdkTable._footerRowOutlet)}hasNextPage(){return this.getCurrentPageIndex()<this.getPageCount()-1}nextPage(){this.goToPage(this.getCurrentPageIndex()+1)}getPaginatedRowIndex(e){return e+this.getPageSize()*this.getCurrentPageIndex()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.Qsj),s.Y36(R),s.Y36(x),s.Y36(void 0))},t.\u0275dir=s.lG2({type:t,inputs:{hiddenColumns:"hiddenColumns",exporter:"exporter"},outputs:{exportCompleted:"exportCompleted",exportStarted:"exportStarted"}}),t})(),r=(()=>{class t extends v{constructor(e,o,c,u){super(e,o,c,u)}ngAfterViewInit(){this.exportStarted.subscribe(e=>{this.enablePaginator(!1)}),this.exportCompleted.subscribe(e=>{this.enablePaginator(!0)})}getPageCount(){return this.getPaginator().getNumberOfPages()}getPageSize(){var e,o;return null!==(o=null===(e=this.getPaginator())||void 0===e?void 0:e.pageSize)&&void 0!==o?o:0}getCurrentPageIndex(){var e,o;return null!==(o=null===(e=this.getPaginator())||void 0===e?void 0:e.pageIndex)&&void 0!==o?o:0}getTotalItemsCount(){var e,o,c,u,_;return null!==(_=null!==(o=null===(e=this.getPaginator())||void 0===e?void 0:e.length)&&void 0!==o?o:null===(u=null===(c=this.getDataSource())||void 0===c?void 0:c.data)||void 0===u?void 0:u.length)&&void 0!==_?_:0}goToPage(e){this.getPaginator().pageIndex=e,this.getPaginator()._changePageSize(this.getPaginator().pageSize)}getPageChangeObservable(){return this.getPaginator().page}getDataSource(){return this._cdkTable.dataSource}getPaginator(){return this.getDataSource().paginator}enablePaginator(e){this.getPaginator()&&(this.getPaginator().disabled=!e,this.getPaginator()._changePageSize(this.getPaginator().pageSize))}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.Qsj),s.Y36(R),s.Y36(x),s.Y36(E.BZ,11))},t.\u0275dir=s.lG2({type:t,selectors:[["","matTableExporter",""]],exportAs:["matTableExporter"],features:[s.qOj]}),t})()},7248:(G,b,S)=>{S.d(b,{JB:()=>R});var E=S(5e3);S(1302);var d=(()=>{return(v=d||(d={})).XLS="xls",v.XLSX="xlsx",v.CSV="csv",v.TXT="txt",v.JSON="json",v.OTHER="other",d;var v})();class m{constructor(r,i){this.extension=r,this.contentTypeHeader=i}}const h=";charset=utf-8",f=d.TXT+"/",g="application/octet-stream",T=".",w=T+d.XLSX,P=T+d.CSV,y=T+d.JSON,A=T+d.TXT,j=(new m(T+d.XLS,g+h),new m(w,g+h),new m(y,f+JSON+h),new m(A,f+d.TXT+h),new m(P,f+d.CSV+h),new E.OlP("XLSX_LIGHTWEIGHT"));class R{static forRoot(r){return{ngModule:R,providers:[{provide:j,useValue:r.xlsxLightWeight}]}}}}}]);